<div class="admin-container">
    <mat-card class="admin-card">
        <mat-card-header>
            <mat-card-title>Administrative Panel</mat-card-title>
            <mat-card-subtitle>Configure system categories, priorities, and SLAs</mat-card-subtitle>
        </mat-card-header>

        <mat-tab-group>
            <!-- Categories Tab -->
            <mat-tab label="Categories">
                <div class="tab-content">
                    <div class="add-action">
                        <mat-form-field appearance="outline">
                            <mat-label>New Category</mat-label>
                            <input matInput [(ngModel)]="newCategoryName" placeholder="e.g. Finance">
                        </mat-form-field>
                        <button mat-raised-button color="primary" [disabled]="!newCategoryName"
                            (click)="addCategory()">Add</button>
                    </div>

                    <table mat-table [dataSource]="categories" class="mat-elevation-z1">
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef> ID </th>
                            <td mat-cell *matCellDef="let element"> {{element.ticketCategoryId}} </td>
                        </ng-container>
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef> Name </th>
                            <td mat-cell *matCellDef="let element"> {{element.categoryName}} </td>
                        </ng-container>
                        <ng-container matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef> Actions </th>
                            <td mat-cell *matCellDef="let element">
                                <button mat-icon-button color="warn" (click)="deleteCategory(element.ticketCategoryId)"
                                    matTooltip="Delete Category">
                                    <mat-icon>delete</mat-icon>
                                </button>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="['id', 'name', 'actions']"></tr>
                        <tr mat-row *matRowDef="let row; columns: ['id', 'name', 'actions'];"></tr>
                    </table>
                </div>
            </mat-tab>

            <!-- Priorities Tab -->
            <mat-tab label="Priorities">
                <div class="tab-content">
                    <div class="add-action">
                        <mat-form-field appearance="outline">
                            <mat-label>New Priority</mat-label>
                            <input matInput [(ngModel)]="newPriorityName" placeholder="e.g. Critical">
                        </mat-form-field>
                        <button mat-raised-button color="primary" [disabled]="!newPriorityName"
                            (click)="addPriority()">Add</button>
                    </div>

                    <table mat-table [dataSource]="priorities" class="mat-elevation-z1">
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef> ID </th>
                            <td mat-cell *matCellDef="let element"> {{element.ticketPriorityId}} </td>
                        </ng-container>
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef> Name </th>
                            <td mat-cell *matCellDef="let element"> {{element.priorityName}} </td>
                        </ng-container>
                        <ng-container matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef> Actions </th>
                            <td mat-cell *matCellDef="let element">
                                <button mat-icon-button color="warn" (click)="deletePriority(element.ticketPriorityId)"
                                    matTooltip="Delete Priority">
                                    <mat-icon>delete</mat-icon>
                                </button>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="['id', 'name', 'actions']"></tr>
                        <tr mat-row *matRowDef="let row; columns: ['id', 'name', 'actions'];"></tr>
                    </table>
                </div>
            </mat-tab>

            <!-- SLAs Tab -->
            <mat-tab label="SLAs">
                <!-- ... existing SLA content ... -->
                <div class="tab-content">
                    <table mat-table [dataSource]="slas" class="mat-elevation-z1">
                        <ng-container matColumnDef="priority">
                            <th mat-header-cell *matHeaderCellDef> Priority </th>
                            <td mat-cell *matCellDef="let element"> {{element.ticketPriority?.priorityName}} </td>
                        </ng-container>
                        <ng-container matColumnDef="hours">
                            <th mat-header-cell *matHeaderCellDef> Response Hours </th>
                            <td mat-cell *matCellDef="let element">
                                <mat-form-field appearance="fill" style="width: 80px;">
                                    <input matInput type="number" [(ngModel)]="element.responseHours"
                                        (change)="updateSLA(element)">
                                </mat-form-field>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="['priority', 'hours']"></tr>
                        <tr mat-row *matRowDef="let row; columns: ['priority', 'hours'];"></tr>
                    </table>
                    <p class="hint">* Changes to SLA hours are saved automatically on change.</p>
                </div>
            </mat-tab>

            <!-- Users Tab -->
            <mat-tab label="Users">
                <div class="tab-content">
                    <div class="mat-elevation-z1 table-container">
                        <table mat-table [dataSource]="users" matSort (matSortChange)="onUsersSortChange($event)"
                            matSortActive="Name" matSortDirection="asc" matSortDisableClear>

                            <!-- Name Column -->
                            <ng-container matColumnDef="name">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header="Name"> Name </th>
                                <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                            </ng-container>

                            <!-- Email Column -->
                            <ng-container matColumnDef="email">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header="Email"> Email </th>
                                <td mat-cell *matCellDef="let element"> {{element.email}} </td>
                            </ng-container>

                            <!-- Role Column -->
                            <ng-container matColumnDef="role">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header="Role.RoleName"> Role </th>
                                <td mat-cell *matCellDef="let element">
                                    <mat-form-field appearance="outline" style="width: 180px;">
                                        <mat-select [(ngModel)]="element.roleId"
                                            (selectionChange)="updateUserRole(element)">
                                            <mat-option *ngFor="let role of availableRoles" [value]="role.roleId"
                                                [disabled]="role.roleName === 'Admin'">
                                                {{role.roleName}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="['name', 'email', 'role']"></tr>
                            <tr mat-row *matRowDef="let row; columns: ['name', 'email', 'role'];"></tr>
                        </table>

                        <mat-paginator [length]="usersTotalCount" [pageSize]="usersPageSize"
                            [pageSizeOptions]="[5, 10, 25, 50]" (page)="onUsersPageChange($event)" showFirstLastButtons>
                        </mat-paginator>

                        <div *ngIf="users.length === 0" class="empty-state-table">
                            No users found.
                        </div>
                    </div>
                </div>
            </mat-tab>
        </mat-tab-group>

        <mat-card-actions align="end">
            <button mat-button (click)="logout()">Logout</button>
        </mat-card-actions>
    </mat-card>
</div>