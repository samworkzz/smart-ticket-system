<div class="reports-container">
    <header class="reports-header">
        <h1>System Reports & Analytics</h1>
        <p>Insights into ticket distribution and SLA compliance</p>
    </header>

    <mat-progress-bar mode="indeterminate" *ngIf="isLoading"></mat-progress-bar>

    <div class="metrics-summary" *ngIf="metrics">
        <mat-card class="summary-card">
            <div class="count">{{metrics.totalTickets}}</div>
            <div class="label">Total Tickets</div>
        </mat-card>
        <mat-card class="summary-card escalated">
            <div class="count">{{metrics.escalatedTickets}}</div>
            <div class="label">Total Escalated</div>
        </mat-card>
        <mat-card class="summary-card" [ngClass]="{'breach': metrics.slaComplianceRate < 80}">
            <div class="count">{{metrics.slaComplianceRate}}%</div>
            <div class="label">SLA Compliance</div>
        </mat-card>
    </div>

    <div class="charts-grid" *ngIf="metrics">
        <!-- Status Distribution -->
        <mat-card class="chart-card">
            <mat-card-header>
                <mat-card-title>Tickets by Status</mat-card-title>
            </mat-card-header>
            <div class="chart-wrapper">
                <ngx-charts-pie-chart [scheme]="colorScheme" [results]="metrics.statusMetrics" [gradient]="true"
                    [legend]="true" [labels]="true" [doughnut]="true">
                </ngx-charts-pie-chart>
            </div>
        </mat-card>

        <!-- Priority distribution -->
        <mat-card class="chart-card">
            <mat-card-header>
                <mat-card-title>Tickets by Priority</mat-card-title>
            </mat-card-header>
            <div class="chart-wrapper">
                <ngx-charts-bar-vertical [scheme]="colorScheme" [results]="metrics.priorityMetrics" [gradient]="true"
                    [xAxis]="true" [yAxis]="true" [legend]="false" [showXAxisLabel]="true" [showYAxisLabel]="true"
                    xAxisLabel="Priority" yAxisLabel="Ticket Count">
                </ngx-charts-bar-vertical>
            </div>
        </mat-card>

        <!-- Category distribution -->
        <mat-card class="chart-card wide">
            <mat-card-header>
                <mat-card-title>Tickets by Category</mat-card-title>
            </mat-card-header>
            <div class="chart-wrapper">
                <ngx-charts-advanced-pie-chart [scheme]="colorScheme" [results]="metrics.categoryMetrics"
                    [gradient]="true">
                </ngx-charts-advanced-pie-chart>
            </div>
        </mat-card>
    </div>
</div>