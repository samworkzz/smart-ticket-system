<div class="report-container">
    <h1>System Overview Report</h1>

    <div *ngIf="isLoading" class="loading-state">
        <p>Loading report data...</p>
    </div>

    <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
    </div>

    <div *ngIf="report && !isLoading" class="content">

        <!-- Ticket Stats -->
        <div class="stats-section">
            <h2>Ticket Statistics</h2>
            <div class="summary-grid">
                <mat-card class="summary-card">
                    <mat-card-header>
                        <mat-card-title>{{ report.totalTickets }}</mat-card-title>
                        <mat-card-subtitle>Total Tickets</mat-card-subtitle>
                    </mat-card-header>
                </mat-card>

                <mat-card class="summary-card">
                    <mat-card-header>
                        <mat-card-title>{{ report.openTickets }}</mat-card-title>
                        <mat-card-subtitle>Open</mat-card-subtitle>
                    </mat-card-header>
                </mat-card>

                <mat-card class="summary-card">
                    <mat-card-header>
                        <mat-card-title>{{ report.resolvedTickets }}</mat-card-title>
                        <mat-card-subtitle>Resolved</mat-card-subtitle>
                    </mat-card-header>
                </mat-card>

                <mat-card class="summary-card highlight-bad">
                    <mat-card-header>
                        <mat-card-title>{{ report.escalatedTickets }}</mat-card-title>
                        <mat-card-subtitle>Escalated</mat-card-subtitle>
                    </mat-card-header>
                </mat-card>
            </div>

            <div class="chart-container">
                <ngx-charts-bar-vertical [scheme]="colorScheme" [results]="ticketStatusData" [gradient]="true"
                    [xAxis]="true" [yAxis]="true" [legend]="false" [showXAxisLabel]="true" [showYAxisLabel]="true"
                    xAxisLabel="Status" yAxisLabel="Count">
                </ngx-charts-bar-vertical>
            </div>
        </div>

        <mat-divider class="divider"></mat-divider>

        <!-- Managers -->
        <div class="managers-section">
            <h2>Managers Directory</h2>
            <table mat-table [dataSource]="report.managerSummaries" class="mat-elevation-z1 full-width-table">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> ID </th>
                    <td mat-cell *matCellDef="let m"> {{m.managerId}} </td>
                </ng-container>
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let m"> {{m.name}} </td>
                </ng-container>
                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef> Email </th>
                    <td mat-cell *matCellDef="let m"> {{m.email}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumnsManagers"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsManagers;"></tr>
            </table>
        </div>

        <mat-divider class="divider"></mat-divider>

        <!-- Agents -->
        <div class="agents-section">
            <h2>Agent Performance Summary</h2>
            <table mat-table [dataSource]="report.agentSummaries" class="mat-elevation-z1 full-width-table">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> ID </th>
                    <td mat-cell *matCellDef="let a"> {{a.agentId}} </td>
                </ng-container>
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let a"> {{a.agentName}} </td>
                </ng-container>
                <ng-container matColumnDef="resolved">
                    <th mat-header-cell *matHeaderCellDef> Resolved Tickets </th>
                    <td mat-cell *matCellDef="let a"> {{a.resolvedCount}} </td>
                </ng-container>
                <ng-container matColumnDef="avgTime">
                    <th mat-header-cell *matHeaderCellDef> Avg Resolution Time </th>
                    <td mat-cell *matCellDef="let a"> {{a.avgResolutionHours}} hrs </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumnsAgents"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsAgents;"></tr>
            </table>
        </div>

    </div>
</div>